---
layout: post
title: A13 소팅(sorting), 데이터 정렬하기 - II 다중 컬럼 정렬 
date:   2015-07-14 14:17:52 +9:00 GMT
permalink: /tutorial/a13
course: basic
categories: 
  - RealGrid
tags: 
  - RealGridJS
  - RealGrid
  - dataprovider
  - itemmodel
  - sort
  - sorting
  - itemIndex
---

<script type="text/javascript" src="/script/dlgrids_eval.js"></script>
<script type="text/javascript" src="/script/realgridjs.js"></script>

<script>
var gridView;
var dataProvider;
    
$(document).ready( function() {

    RealGridJS.setTrace(false);
    RealGridJS.setRootContext("/script");
    
    dataProvider = new RealGridJS.LocalDataProvider();
    gridView = new RealGridJS.GridView("realgrid");
    gridView.setDataSource(dataProvider);
    
    //두 개의 필드를 가진 배열 객체를 생성합니다.
    var fields = [
        {
            fieldName: "field1"
        },
        {
            fieldName: "field2"
        },
        {
            fieldName: "field3"
        }
    ];
    //DataProvider의 setFields함수로 필드를 입력합니다.
    dataProvider.setFields(fields);

    //field1필드와 연결된 컬럼을 가진 배열 객체를 생성합니다.
    var columns = [
        {
            name: "col1",
            fieldName: "field1",
            header : {
                text: "이름"
            },
            width: 150
        },
        {
            name: "col2",
            fieldName: "field2",
            header : {
                text: "국어"
            },
            width: 150
        },
        {
            name: "col3",
            fieldName: "field3",
            header : {
                text: "수학"
            },
            width: 150
        }
    ];
    //컬럼을 GridView에 입력 합니다.
    gridView.setColumns(columns);

    var data = [
        ["송윤아", "10", "33"],
        ["전도연", "10", "22"],
        ["하지원", "20", "11"],
        ["전지현", "20", "44"]
    ];
    dataProvider.setRows(data);

    //두 번째 필드의 데이터를 기준으로 역순으로 정렬
    function changeOrder(){
        var fields = ["field2"];
        var dirs = [RealGridJS.SortDirection.DESCENDING];
        gridView.orderBy(fields, dirs);
    }

    //버튼을 클릭하면 정렬순서를 바꿉니다.
    $("#btnChangeOrder").on("click", function(){
        changeOrder();
    })    

});
</script>

### 들어가며

[A11 강좌]()에서 이미 ```orderBy();``` 함수를 이용해 정렬하는 방법이 언급되었습니다. 이번 강좌에서는 정렬(sorting)에 대해 좀더 자세히 배워보겠습니다.

### 이론

RealGrid에서 정렬이란 특정 컬럼의 데이터값에 의해 행의 순서를 재배열 하는 것을 의미 합니다.  
정렬은 **단일 컬럼 정렬(exclusive)**과 **다중 컬럼 정렬(inclusive, reverse)**로 구분 할 수 있으며, **순방향(ascending)**과 **역방향(decending)**의 정렬방법이 있습니다.  

그림에서 처럼 정렬 명령은 Controller가 받아서 ItemModel을 재구성하는 과정으로 처리됩니다. 정렬 명령을 내리는 방법은 `컬럼 클릭(Column Click)` 방법과 `orderBy();`함수를 호출 하는 방법이 있습니다.

![](/images/blog/20150713-realgrid-a12.png)

* 컬럼 클릭 방법   
    컬럼 클릭은 아래 세가지 방법으로 토글(toggle) 됩니다.
    * 첫 번째 클릭: 순방향(ascending) 정렬
    * 두 번째 클릭: 역방향(decending) 정렬
    * 세 번째 클릭: 원래 데이터의 순서(RowId 순서)로 정렬

### 실습

소스코드는 [A10 강좌](/tutorial/a10)에서 함수 부분과 버튼클릭 이벤트 부분이 변경된 것입니다.

1. setCurrent2Row()함수는 포커스를 두 번째 행에 가도록 하는 함수입니다. GridView.getCurrent()함수의 리턴값인 CollIndex의 dataRow값을 변경하도록 했지만, 현재상태는 ItemIndex와 RowId가 같기 때문에 코드에서 `current.dataRow = 1;`을 `current.itemIndex = 1;`로 바꾸어도 동일한 결과를 얻을 수 있습니다.

    <pre class="prettyprint">
    //동적으로 두 번째 행에 포커스 되도록 함수
    function setCurrent2Row(){
        var current = gridView.getCurrent();
        <mark>current.dataRow = 1;</mark>
        gridView.setCurrent(current);
    }</pre>

2. popupIndex()함수는 포커스된 셀의 ItemIndex와 RowId를 팝업합니다.

    <pre class="prettyprint">
    //ItemIndex와 RowId를 팝업하는 함수
    function popupIndex(){
        var focusCell = gridView.getCurrent();
        alert("ItemIndex:" + focusCell.itemIndex + ", RowId:" + focusCell.dataRow);
    }</pre>

3. changeOrder()함수는 두 번째 컬럼 데이터의 역순으로 그리드의 정렬순서를 변경합니다. [GridView.orderBy();](http://help.realgrid.com/api/GridBase/orderBy/)함수에 대해서는 별도의 강좌에서 배울수 있습니다.

    <pre class="prettyprint">
    //두 번째 필드의 데이터를 기준으로 역순으로 정렬
    function changeOrder(){
        var fields = ["field2"];
        var dirs = [RealGridJS.SortDirection.DESCENDING];
        gridView.orderBy(fields, dirs);
    }</pre>

4. 아래 코드는 각 버튼의 클릭 이벤트 입니다.

    <pre class="prettyprint">
    //버튼을 클릭하면 포커스행을 두번째 행으로 선택합니다.
    $("#btnSetCurrent2Row").on("click", function(){
        setCurrent2Row();
    })    

    //버튼을 클릭하면 ItemIndex와 RowId를 표시 합니다.
    $("#btnPopupIndex1").on("click", function(){
        popupIndex();
    })    
    //버튼을 클릭하면 정렬순서를 바꿉니다.
    $("#btnChangeOrder").on("click", function(){
        changeOrder();
    })    

    //버튼을 클릭하면 ItemIndex와 RowId를 표시 합니다.
    $("#btnPopupIndex2").on("click", function(){
        popupIndex();
    })</pre>

### 실행화면

아래 버튼을 순서대로 클릭하면서 ItemIndex와 RowId의 값이 어떻게 바뀌는지 확인해 보세요. 

<button type="button" class="btn btn-primary btn-xs" id="btnChangeOrder">3. 정렬순서 변경하기</button>

<div id="realgrid" style="width: 100%; height: 200px;"></div>
<p></p>

### 나가며

정렬하기전 두 번째 행의 ItemIndex는 1, RowId는 1 입니다.  
정렬이 바뀐 다음 두 번째 행의 ItemIndex는 1, RowId는 2 입니다.  
이 결과를 보고 정렬이 바뀌면 RowId가 바뀐다고 생각하시는 분은 없으시겠죠?    
그래도 RowId가 바뀌었다고 생각되시는 분은 [support@wrw.kr](mailto:suppoert@wrw.kr)로 메일 주시기 바랍니다.


---
**참조**

* [RealGrid Help](http://help.realgrid.com){:target="_blank"}